<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sartarosh</title>

  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      background: #0f172a;
      color: white;
    }

    #app {
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin-bottom: 16px;
    }

    button.secondary {
      width: 100%;
      padding: 14px;
      margin-bottom: 12px;
      background: #1e293b;
      border: 1px solid #334155;
      color: white;
      border-radius: 12px;
      font-size: 16px;
      text-align: center;
    }

    .barber-card {
      display: flex;
      gap: 12px;
      background: #1e293b;
      border-radius: 14px;
      padding: 12px;
      margin-bottom: 14px;
      align-items: center;
      cursor: pointer;
    }

    .barber-card:active {
      background: #334155;
    }

    .avatar {
      width: 64px;
      height: 64px;
      border-radius: 12px;
      object-fit: cover;
    }

    .info {
      flex: 1;
    }

    .name {
      font-weight: 600;
      font-size: 16px;
    }

    .rating {
      font-size: 13px;
      opacity: 0.8;
      margin-top: 2px;
    }

    .price {
      font-size: 14px;
      margin-top: 4px;
    }

    .location {
      font-size: 12px;
      opacity: 0.75;
      margin-top: 4px;
      text-decoration: underline;
      cursor: pointer;
    }

    .cta {
      font-size: 13px;
      opacity: 0.9;
      white-space: nowrap;
    }

    input.search {
      width: 100%;
      padding: 12px;
      margin-bottom: 16px;
      border-radius: 12px;
      border: none;
      font-size: 15px;
      outline: none;
    }
  </style>
</head>

<body>
  <div id="app"></div>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    const BARBERS = [
      {
        name: "–î–æ–Ω–∏—ë—Ä",
        exp: "5 –ª–µ—Ç –æ–ø—ã—Ç–∞",
        cut: 120000,
        beard: 80000,
        tg: "d_zafarogli",
        photo: "https://github.com/doniyoryz/Telegram-mini-app/blob/main/man.jpg?raw=true",
        address: "–¢–µ–º—É—Ä –ú–∞–ª–∏–∫ 27"
        lat: 41.348373,
        lng: 69.356767
      },
      {
        name: "–ë–∞—Ö—Ç–∏—ë—Ä",
        exp: "fade, –±–æ—Ä–æ–¥–∞",
        cut: 100000,
        beard: 70000,
        tg: "ryoithab",
        photo: "https://github.com/doniyoryz/Telegram-mini-app/blob/main/baxa.jpg?raw=true",
        address: "–§–µ—Ä—É–∑–∞ 2, 7-–¥–æ–º"
        lat: 41.350620,
        lng: 69.360765
      },
      {
        name: "–ú–∞—Ö–º—É–¥",
        exp: "–∫–ª–∞—Å—Å–∏–∫–∞",
        cut: 90000,
        beard: 60000,
        tg: "CJskadi",
        photo: "https://github.com/doniyoryz/Telegram-mini-app/blob/main/maxa.jpg?raw=true",
        address: "–ê–±–∞–π"
        lat: 41.325278,
        lng: 69.257854
      },
      {
        name: "–ò—Å–ª–æ–º",
        exp: "—É–Ω–∏–≤–µ—Ä—Å–∞–ª",
        cut: 85000,
        beard: 55000,
        tg: "isa_abd09",
        photo: "https://github.com/doniyoryz/Telegram-mini-app/blob/main/isa.jpg?raw=true",
        address: "–¢—É–∑–µ–ª—å"
        lat: 41.307816,
        lng: 69.426187
      }
    ];

    let booking = {};
    let searchQuery = "";

    function openYandexMap(address) {
      const url = `https://yandex.uz/maps/?text=${encodeURIComponent(address)}`;
      window.open(url, "_blank");
    }

    function onSearch(value) {
      searchQuery = value;
      showAllBarbers();
    }

    function showAllBarbers() {
      let html = `
        <h1>üíà –í—ã–±–µ—Ä–∏—Ç–µ –±–∞—Ä–±–µ—Ä–∞</h1>
        <input
          class="search"
          type="text"
          placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ –∞–¥—Ä–µ—Å—É"
          value="${searchQuery}"
          oninput="onSearch(this.value)"
        />
      `;

      const filtered = BARBERS.filter(b =>
        b.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
        b.address.toLowerCase().includes(searchQuery.toLowerCase())
      );

      if (filtered.length === 0) {
        html += `<p style="opacity:0.6;text-align:center">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>`;
      }

      filtered.forEach(b => {
        html += `
          <div class="barber-card" onclick="selectBarber('${b.name}', '${b.tg}', '${b.address}')">
            <img class="avatar" src="${b.photo}" />
            <div class="info">
              <div class="name">${b.name}</div>
              <div class="rating">‚≠ê 4.8 ‚Ä¢ ${b.exp}</div>
              <div class="price">‚úÇÔ∏è –æ—Ç ${b.cut.toLocaleString()} —Å—É–º</div>
              <div class="location"
                onclick="event.stopPropagation(); openYandexMap('${b.address}')">
                üìç ${b.address}
              </div>
            </div>
            <div class="cta">–í—ã–±—Ä–∞—Ç—å</div>
          </div>
        `;
      });

      document.getElementById("app").innerHTML = html;
    }

    function selectBarber(name, tg, address) {
      booking = { barber: name, tg, address };

      document.getElementById("app").innerHTML = `
        <h1>‚úÇÔ∏è –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</h1>

        <button class="secondary" onclick="selectService('–°—Ç—Ä–∏–∂–∫–∞')">‚úÇÔ∏è –°—Ç—Ä–∏–∂–∫–∞</button>
        <button class="secondary" onclick="selectService('–ë–æ—Ä–æ–¥–∞')">üßî –ë–æ—Ä–æ–¥–∞</button>
        <button class="secondary" onclick="selectService('–ö–æ–º–ø–ª–µ–∫—Å')">üíà –ö–æ–º–ø–ª–µ–∫—Å</button>
        <button class="secondary" onclick="showAllBarbers()">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
      `;
    }

    function selectService(service) {
      booking.service = service;

      const today = new Date().toDateString();
      const tomorrow = new Date(Date.now() + 86400000).toDateString();

      document.getElementById("app").innerHTML = `
        <h1>üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</h1>
        <button class="secondary" onclick="selectDate('${today}')">–°–µ–≥–æ–¥–Ω—è</button>
        <button class="secondary" onclick="selectDate('${tomorrow}')">–ó–∞–≤—Ç—Ä–∞</button>
        <button class="secondary" onclick="selectBarber(booking.barber, booking.tg, booking.address)">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
      `;
    }

    function selectDate(date) {
      booking.date = date;
      const times = ["10:00","11:00","12:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00"];

      let html = `<h1>‚è∞ –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è</h1>`;
      times.forEach(t => {
        html += `<button class="secondary" onclick="confirmBooking('${t}')">${t}</button>`;
      });

      html += `<button class="secondary" onclick="selectService(booking.service)">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>`;
      document.getElementById("app").innerHTML = html;
    }

    function confirmBooking(time) {
      booking.time = time;

      document.getElementById("app").innerHTML = `
        <h1>‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h1>
        üíà –ë–∞—Ä–±–µ—Ä: ${booking.barber}<br>
        ‚úÇÔ∏è –£—Å–ª—É–≥–∞: ${booking.service}<br>
        üìÖ –î–∞—Ç–∞: ${booking.date}<br>
        ‚è∞ –í—Ä–µ–º—è: ${booking.time}<br><br>

        <button class="secondary" onclick="contact(booking.tg)">üì© –ù–∞–ø–∏—Å–∞—Ç—å –±–∞—Ä–±–µ—Ä—É</button>
        <button class="secondary" onclick="showAllBarbers()">üîÅ –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å</button>
      `;
    }

    function contact(username) {
      window.open("https://t.me/" + username, "_blank");
    }

    showAllBarbers();
  </script>
</body>
</html>

