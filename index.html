<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sartarosh</title>

<style>
body {
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:#0f172a;
  color:white;
}
#app { padding:20px; }
h1 { text-align:center;margin-bottom:14px; }

input, select {
  width:100%;
  padding:12px;
  margin-bottom:12px;
  border-radius:12px;
  border:none;
  font-size:15px;
}

.barber-card {
  display:flex;
  gap:12px;
  background:#1e293b;
  padding:12px;
  border-radius:14px;
  margin-bottom:12px;
  cursor:pointer;
}

.avatar {
  width:64px;
  height:64px;
  border-radius:12px;
  object-fit:cover;
}

.info { flex:1; }
.name { font-weight:600;font-size:16px; }
.small { font-size:13px;opacity:.75; }

button {
  width:100%;
  padding:14px;
  margin-top:10px;
  border-radius:12px;
  border:none;
  font-size:16px;
}

.primary { background:#22c55e;color:black; }
.secondary {
  background:#1e293b;
  color:white;
  border:1px solid #334155;
}

.slot {
  padding:14px;
  border-radius:12px;
  margin-bottom:8px;
  background:#1e293b;
  cursor:pointer;
}

.busy {
  opacity:.4;
  cursor:not-allowed;
}
</style>
</head>

<body>
<div id="app"></div>

<script>
/* ===== DATA ===== */
const BARBERS = [
  {
    name:"–î–æ–Ω–∏—ë—Ä",
    exp:"5 –ª–µ—Ç –æ–ø—ã—Ç–∞",
    cut:120000,
    tg:"d_zafarogli",
    address:"–¢–µ–º—É—Ä –ú–∞–ª–∏–∫ 27",
    lat:41.348373,
    lng:69.356767,
    photo:"https://github.com/doniyoryz/Telegram-mini-app/blob/main/man.jpg?raw=true"
  },
  {
    name:"–ë–∞—Ö—Ç–∏—ë—Ä",
    exp:"fade, –±–æ—Ä–æ–¥–∞",
    cut:100000,
    tg:"ryoithab",
    address:"–§–µ—Ä—É–∑–∞ 2, 7-–¥–æ–º",
    lat:41.350620,
    lng:69.360765,
    photo:"https://github.com/doniyoryz/Telegram-mini-app/blob/main/baxa.jpg?raw=true"
  },
  {
    name:"–ú–∞—Ö–º—É–¥",
    exp:"–∫–ª–∞—Å—Å–∏–∫–∞",
    cut:90000,
    tg:"CJskadi",
    address:"–ê–±–∞–π",
    lat:41.325278,
    lng:69.257854,
    photo:"https://github.com/doniyoryz/Telegram-mini-app/blob/main/maxa.jpg?raw=true"
  },
  {
    name:"–ò—Å–ª–æ–º",
    exp:"—É–Ω–∏–≤–µ—Ä—Å–∞–ª",
    cut:85000,
    tg:"isa_abd09",
    address:"–¢—É–∑–µ–ª—å",
    lat:41.307816,
    lng:69.426187,
    photo:"https://github.com/doniyoryz/Telegram-mini-app/blob/main/isa.jpg?raw=true"
  }
];

// demo busy slots
const BUSY = {
  "–î–æ–Ω–∏—ë—Ä":["11:00","15:00"],
  "–ë–∞—Ö—Ç–∏—ë—Ä":["12:00"]
};

let booking = {};
let search = "";
let maxPrice = 200000;

/* ===== LIST ===== */
function showAll(){
  let html = `
    <h1>üíà –ë–∞—Ä–±–µ—Ä—ã</h1>

    <input placeholder="üîç –ò–º—è –∏–ª–∏ –∞–¥—Ä–µ—Å"
      oninput="search=this.value;showAll()">

    <select onchange="maxPrice=this.value;showAll()">
      <option value="200000">–õ—é–±–∞—è —Ü–µ–Ω–∞</option>
      <option value="100000">–¥–æ 100 000</option>
    </select>
  `;

  BARBERS
    .filter(b =>
      (b.name+b.address).toLowerCase().includes(search.toLowerCase())
      && b.cut <= maxPrice
    )
    .forEach(b=>{
      html+=`
        <div class="barber-card" onclick="openProfile('${b.name}')">
          <img class="avatar" src="${b.photo}">
          <div class="info">
            <div class="name">${b.name}</div>
            <div class="small">‚úÇÔ∏è –æ—Ç ${b.cut.toLocaleString()} —Å—É–º</div>
            <div class="small">üìç ${b.address}</div>
          </div>
        </div>
      `;
    });

  app.innerHTML = html;
}

/* ===== PROFILE ===== */
function openProfile(name){
  booking.barber = BARBERS.find(b=>b.name===name);

  app.innerHTML = `
    <h1>${booking.barber.name}</h1>

    <img src="${booking.barber.photo}"
      style="width:100%;border-radius:18px;margin-bottom:12px">

    <p class="small">üìç ${booking.barber.address}</p>
    <p class="small">‚úÇÔ∏è –æ—Ç ${booking.barber.cut.toLocaleString()} —Å—É–º</p>

    <button class="primary" onclick="chooseService()">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>
    <button class="secondary" onclick="showAll()">–ù–∞–∑–∞–¥</button>
  `;
}

/* ===== SERVICE ===== */
function chooseService(){
  app.innerHTML = `
    <h1>–£—Å–ª—É–≥–∞</h1>

    <button class="secondary"
      onclick="booking.service='–°—Ç—Ä–∏–∂–∫–∞';chooseDate()">
      ‚úÇÔ∏è –°—Ç—Ä–∏–∂–∫–∞
    </button>

    <button class="secondary"
      onclick="booking.service='–ë–æ—Ä–æ–¥–∞';chooseDate()">
      üßî –ë–æ—Ä–æ–¥–∞
    </button>

    <button class="secondary"
      onclick="openProfile(booking.barber.name)">
      –ù–∞–∑–∞–¥
    </button>
  `;
}

/* ===== DATE ===== */
function chooseDate(){
  const today = new Date().toDateString();
  const tomorrow = new Date(Date.now()+86400000).toDateString();

  app.innerHTML = `
    <h1>–î–∞—Ç–∞</h1>

    <button class="secondary"
      onclick="booking.date='${today}';chooseTime()">
      –°–µ–≥–æ–¥–Ω—è
    </button>

    <button class="secondary"
      onclick="booking.date='${tomorrow}';chooseTime()">
      –ó–∞–≤—Ç—Ä–∞
    </button>

    <button class="secondary" onclick="chooseService()">–ù–∞–∑–∞–¥</button>
  `;
}

/* ===== TIME ===== */
function chooseTime(){
  const times = ["10:00","11:00","12:00","14:00","15:00","16:00","17:00"];
  const busy = BUSY[booking.barber.name] || [];

  let html = `<h1>–í—Ä–µ–º—è</h1>`;

  times.forEach(t=>{
    const isBusy = busy.includes(t);
    html += `
      <div class="slot ${isBusy?'busy':''}"
        onclick="${isBusy?'':`confirmBooking('${t}')`}">
        ‚è∞ ${t} ${isBusy?'‚Äî –∑–∞–Ω—è—Ç–æ':''}
      </div>
    `;
  });

  html += `<button class="secondary" onclick="chooseDate()">–ù–∞–∑–∞–¥</button>`;
  app.innerHTML = html;
}

/* ===== CONFIRM ===== */
function confirmBooking(time){
  booking.time = time;

  const msg = `–ó–∞–ø–∏—Å—å:
–ë–∞—Ä–±–µ—Ä: ${booking.barber.name}
–£—Å–ª—É–≥–∞: ${booking.service}
–î–∞—Ç–∞: ${booking.date}
–í—Ä–µ–º—è: ${booking.time}`;

  app.innerHTML = `
    <h1>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h1>

    <p>${msg.replaceAll("\n","<br>")}</p>

    <button class="primary"
      onclick="window.open(
        'https://t.me/${booking.barber.tg}?text=${encodeURIComponent(msg)}'
      )">
      –û—Ç–ø—Ä–∞–≤–∏—Ç—å –±–∞—Ä–±–µ—Ä—É
    </button>

    <button class="secondary" onclick="showAll()">–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å</button>
  `;
}

/* START */
showAll();
</script>
</body>
</html>

